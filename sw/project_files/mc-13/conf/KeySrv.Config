/**
*  @file      KeySrv.Cofig
*  @brief     Config data for key server
*  @author    Bob.Xu
*  @date      27-Feb-2014
*  @copyright Tymphany Ltd.
*/
#include "AdcDrv.h"
#include "GpioDrv.h"
#include "AdcKeyDrv.h"
#include "GpioKeyDrv.h"

#define DEBOUNCE_SAMP_NUM               4
#define KEY_SERVER_TICK_MS              10
#define COMB_KEY_FLAG_RESET             0

/* Private variables */

static cAdcKeyDrv adcKeySet[NUM_OF_ADC_KEY];
static cGpioKeyDrv gpioKeySet[NUM_OF_GPIO_KEY];
static cGpioDrv gpioDrvForKey;
static cADCDrv adcDrvForKey;

#ifdef HAS_INTERRUPT_WAKE_UP_KEY
#define POWER_MANAGER   MAIN_APP_ID
#endif

const tKeySrvConfig keySrvConfig =
{
    .timing.debounceTime = 60, /* 60ms */
    .timing.repeatStartTime= 1000,
    .timing.longPressTime = 1000,  /* 1S */
    .timing.veryLongPressTime = 5000, /* 5S */

    /* If repeatHoldTime[x] > 0, then after sent KEY_EVT_HOLD, post KEY_EVT_REPEAT in every repeatHoldTime[x] *
    * for the specific key until veryLongPressTime                                                            *
    * If repeatHoldTime[x] = 0, it means that it is not required to send KEY_EVT_REPEAT for the specific key. */
    .timing.repeatHoldTime[VOLUME_DOWN_KEY] =  180, /* 1s  this value should be changed according to user cases in applicaiton */
    .timing.repeatHoldTime[VOLUME_UP_KEY] =  180,   /* 1s this value should be changed according to user cases in applicaiton*/
    .timing.repeatHoldTime[POWER_KEY] =  2000,   /* 1s this value should be changed according to user cases in applicaiton*/

    .keyboardNum = KEYBOARD_NUMBER,
    .keyboardSet =
    {
        {ADC_DEV_TYPE, (cKeyDrv*)adcKeySet,   sizeof(cAdcKeyDrv),    &adcDrvForKey},
        {GPIO_DEV_TYPE, (cKeyDrv*)gpioKeySet,  sizeof(cGpioKeyDrv),   &gpioDrvForKey},
        /**
         * you can add other types of keyboard here
         */
    }
};

#ifdef HAS_COMB_KEY
#define NUM_OF_COMB_KEYS    5

static tCombKeyElem  combKeyGroup0[] =
{
    {.keyId = POWER_KEY, .combKeyTrigEvt = KEY_EVT_VERY_LONG_HOLD},
    {.keyId = BT_KEY,    .combKeyTrigEvt = KEY_EVT_VERY_LONG_HOLD},
};

static tCombKeyElem  combKeyGroup1[] =
{
    {.keyId = POWER_KEY,     .combKeyTrigEvt = KEY_EVT_VERY_LONG_HOLD},
    {.keyId = VOLUME_UP_KEY, .combKeyTrigEvt = KEY_EVT_VERY_LONG_HOLD},
};

static tCombKeyElem  combKeyGroup2[] =
{
    {.keyId = PLAY_PAUSE_KEY, .combKeyTrigEvt = KEY_EVT_SHORT_PRESS},
    {.keyId = PLAY_PAUSE_KEY, .combKeyTrigEvt = KEY_EVT_SHORT_PRESS},
};

static tCombKeyElem  combKeyGroup3[] =
{
    {.keyId = PLAY_PAUSE_KEY, .combKeyTrigEvt = KEY_EVT_SHORT_PRESS},
    {.keyId = PLAY_PAUSE_KEY, .combKeyTrigEvt = KEY_EVT_SHORT_PRESS},
    {.keyId = PLAY_PAUSE_KEY, .combKeyTrigEvt = KEY_EVT_SHORT_PRESS},
};

static tCombKeyElem  combKeyGroup4[] =
{
    {.keyId = VOLUME_UP_KEY,  .combKeyTrigEvt = KEY_EVT_SHORT_PRESS},
    {.keyId = VOLUME_DOWN_KEY,.combKeyTrigEvt = KEY_EVT_SHORT_PRESS},
    {.keyId = BT_KEY,         .combKeyTrigEvt = KEY_EVT_SHORT_PRESS},
    {.keyId = BT_KEY,         .combKeyTrigEvt = KEY_EVT_SHORT_PRESS},
};
static tCombDef combKeysDef[NUM_OF_COMB_KEYS] =
{
    {
        .combKeyId = COMB_KEY_ID_0,
        .combKeyType = NORMAL_KEY_COMB_TYPE,
        .numOfKeyElem = 2,
        .timeElapse = 0,
        .resetTime = 5000, /* 5 seconds */
        .pCombKeyElems = combKeyGroup0,
    },
    {
        .combKeyId = COMB_KEY_ID_1,
        .combKeyType = NORMAL_KEY_COMB_TYPE,
        .numOfKeyElem = 2,
        .timeElapse = 0,
        .resetTime = 5000, /* 5 seconds */
        .pCombKeyElems = combKeyGroup1,
    },
    {
        .combKeyId = COMB_KEY_ID_2,
        .combKeyType = SEQ_KEY_PRESS_COMB_TYPE,
        .numOfKeyElem = 2,
        .timeElapse = 0,
        .resetTime = 500, /* 1 second */
        .pCombKeyElems = combKeyGroup2,
    },
    {
        .combKeyId = COMB_KEY_ID_3,
        .combKeyType = SEQ_KEY_PRESS_COMB_TYPE,
        .numOfKeyElem = 3,
        .timeElapse = 0,
        .resetTime = 500, /* 1 second */
        .pCombKeyElems = combKeyGroup3,
    },
    {
        .combKeyId = COMB_KEY_ID_4,
        .combKeyType = SEQ_KEY_PRESS_COMB_TYPE,
        .numOfKeyElem = 4,
        .timeElapse = 0,
        .resetTime = 5000, /* 5 seconds */
        .pCombKeyElems = combKeyGroup4,
    },    
};
#endif

